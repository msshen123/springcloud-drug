<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>品牌管理</title>
    <meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport">
    <link rel="stylesheet" href="../plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../plugins/adminLTE/css/AdminLTE.css">
    <link rel="stylesheet" href="../plugins/adminLTE/css/skins/_all-skins.min.css">
    <link rel="stylesheet" href="../css/style.css">
    <script src="../plugins/jQuery/jquery-2.2.3.min.js"></script>
    <script src="../plugins/bootstrap/js/bootstrap.min.js"></script>
    <script src="../js/vue/vue.min.js"></script>
    <script src="../plugins/bootstrap/bootstrap-paginator.js"></script>
</head>
<body class="hold-transition skin-red sidebar-mini">
<!-- .box-body -->
<div class="box-header with-border">
    <h3 class="box-title">品牌管理</h3>
</div>

<div class="box-body" id="app">

    <!-- 数据表格 -->
    <div class="table-box">

        <!--工具栏-->
        <div class="pull-left">
            <div class="form-group form-inline">
                <div class="btn-group">
                    <button type="button" class="btn btn-default" title="新建" data-toggle="modal" data-target="#editModal" v-on:click="brand = {}"><i class="fa fa-file-o"></i> 新建</button>
                    <button type="button" class="btn btn-default" title="删除" v-on:click="deleteBrand()"><i class="fa fa-trash-o"></i> 删除</button>
                    <button type="button" class="btn btn-default" title="刷新" onclick="window.location.reload();"><i class="fa fa-refresh"></i> 刷新</button>
                </div>
            </div>
        </div>
        <div class="box-tools pull-right">
            <div class="has-feedback">
                品牌名称：<input type="text" v-model="name" />
                品牌首字母：<input type="text" v-model="firstChar" />
                <button type="button" class="btn bg-olive" onclick="searchBrand()">查询</button>
            </div>
        </div>
        <!--工具栏/-->

        <!--数据列表-->
        <table id="dataList" class="table table-bordered table-striped table-hover dataTable">
            <thead>
            <tr>
                <th class="" style="padding-right:0px">
                    <input id="selall" type="checkbox" class="icheckbox_square-blue">
                </th>
                <th class="sorting_asc">物料编号</th>
                <th class="sorting">物料名称</th>
                <th class="sorting">缩略图</th>
                <th class="text-center">物料类型</th>
                <th class="text-center">价格</th>
                <th class="text-center">库存数量</th>
                <th class="text-center">剩余数量</th>
            </tr>
            </thead>
            <tbody>
            <tr v-for="brand in kmList">
                <td><input  type="checkbox" v-on:click="updateSelection($event, brand.materialsId)"></td>
                <td>{{brand.materialsId}}</td>
                <td>{{brand.materialsName}}</td>
                <td>{{brand.thumb}}</td>
                <td>{{brand.materialsType}}</td>
                <td>{{brand.price}}</td>
                <td>{{brand.count}}</td>
                <td>{{brand.remaincount}}</td>
                <td class="text-center">
                    <button type="button" class="btn bg-olive btn-xs" data-toggle="modal" data-target="#editModal" v-on:click="findOne(brand.id)" >修改</button>
                </td>
            </tr>

            </tbody>
        </table>
        <div id="example" style="text-align: center"> <ul id="pageLimit"></ul> </div>

    </div>
    <!-- 数据表格 /-->


    <!-- 编辑窗口 -->
    <div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" >
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h3 id="myModalLabel">品牌编辑</h3>
                </div>
                <div class="modal-body">
                    <table class="table table-bordered table-striped"  width="800px">
                        <tr>
                            <td>品牌名称</td>
                            <td><input  class="form-control" placeholder="品牌名称" v-model="brand.name">  </td>
                        </tr>
                        <tr>
                            <td>首字母</td>
                            <td><input  class="form-control" placeholder="首字母" v-model="brand.firstChar">  </td>
                        </tr>
                        <input type="hidden" v-model="brand.id">
                    </table>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-success" data-dismiss="modal" aria-hidden="true" v-on:click="saveBrand()">保存</button>
                    <button class="btn btn-default" data-dismiss="modal" aria-hidden="true">关闭</button>
                </div>
            </div>
        </div>
    </div>

</div>

</body>
<script>
    var vm = new Vue({
        el:'#app',
        data: {
            kmList: '',
            total:'',
            page:'',
            rows:'',
            totalPage:'',
            name:'',
            firstChar:'',
            brand: {
                materialsId:'',
                materialsName:'',
                thumb:'',
                materialsType:'',
                price:"",
                count:"",
                remaincount:""
            },
            selectIds: ''
        }
    })
    $(function () {
        //searchBrand();
        searchBrandPagination();
        $('#pageLimit').bootstrapPaginator({
            currentPage: 1,//当前的请求页面。
            totalPages: vm.totalPage,//一共多少页。
            size:"normal",//应该是页眉的大小。
            bootstrapMajorVersion: 3,//bootstrap的版本要求。
            alignment:"right",
            numberOfPages:5,//一页列出多少数据。
            itemTexts: function (type, page, current) {//如下的代码是将页眉显示的中文显示我们自定义的中文。
                switch (type) {
                    case "first": return "首页";
                    case "prev": return "上一页";
                    case "next": return "下一页";
                    case "last": return "末页";
                    case "page": return page;
                }
            }
        });
    })
    function searchBrandPagination() {
        $.ajax({
            type:'post',
            url:'/mat/findpage',
            data:{'materialsName': vm.materialsName, 'thumb': vm.thumb},
            dataType:'json',
            async: false,
            success: function (result) {
                vm.kmList = result.rows;
                vm.total = result.total;
                vm.totalPage = result.totalPage;
                vm.page = result.page;
                vm.rows = result.pageSize ;
            },
            error: function () {
                alert("系统错误，请联系管理员！");
            }
        })
    }

    //复选框选中
    vm.selectIds=[];
      function updateAelection($event,id){
          if($event.target.checked){
              vm.selectIds.push(id);
          }else{
              var idx=vm.selectIds.indexOf(id);
              vm.selectIds.splice(idx,1);
          }
          console.info(vm.selectIds.toString());
      }
      //删除
    function deleteBrand(){
          $.ajax({
              type:"post",
              url:"<>"
          })

    }
</script>
</html>